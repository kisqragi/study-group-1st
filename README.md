# 学内勉強会第１回 <基本のコマンド操作を覚えよう>
stc{hoge}というflagを用意しているので、練習がてらに見つけてみましょう。  

## 1. 使用するディレクトリ/フォルダを準備しよう
ターミナルを開いてコマンドを実行しよう  
```
git clone https://github.com/kisqragi/study-group-1st.git
```
もしかしたら
```
sudo apt install git
```
のようなメッセージが出るかも知れません。  
これはコマンドがないと言われているので、インストールする必要があります。  
インストールはとても簡単です。  
上記のメッセージに書かれている `sudo apt install git` を実行すれば良いだけです。  
早速入力しましょう。  
(Y/N)を聞かれますが、yと打てば大丈夫です。(yesのy)  

この操作はLinuxを使う上で割と行うので、コマンドが使えなかったときはメッセージに書いてあるコマンドを実行してインストールすれば大抵は大丈夫です。  

gitコマンドが使えるようになったら最初のコマンドを実行。  
`ls`コマンドでディレクトリがあるか確認してください。  
上手くいっていればstudy-group-1stというディレクトリができているはずです。  
## 2. ディレクトリを自由に行き来しよう
study-group-1stの中に移動してみましょう。  
`cd <ディレクトリ名>` で好きなディレクトリに移動することができます。  
今回は `cd study-group-1st` で実行  
移動できたら`pwd`と打ち込んで今の場所を確認。  
`ls`コマンドでstudy-group-1stディレクトリ内にどんなファイルがあるか確認してみよう。  
移動操作ができるようになったらstudy-group-1st内のwork-1に移動してflagを見つけよう。  
(flagはstc{hoge}という型式です。)  

## 3.ファイルの中身をみよう
今度はファイルの中身を見てみましょう。  
ファイルの中身を見るコマンドはいくつかありますが、今回はcatとlessコマンドを使います。  
では、study-group-1st内のwork-2に移動しましょう...  
work-2なんてないよ、って人は `cd ..` もしくは `cd` のみを実行しましょう。  
`cd ..` では今いるディレクトリの一つ上の階層のディレクトリに移動できます。  
`cd` のみの実行ではターミナルを開いた時と同じディレクトリ(ホームディレクトリ)に移動します。  
study-group-1st内のwork-2に移動できたら中にcat_fileとless_fileがあるのでそのファイルの中身をみていきます。  
```
cat <ファイル名>  
less <ファイル名>
```
で中身を見ることができます。  
### <u>catコマンド</u>
catコマンドでまず `work-2/cat_file` の中身を見てみましょう。  
work-2に移動して以下のコマンドを実行します。  
```
cat cat_file
```
cat_fileの中身が見れたと思います。  

catコマンドはconCATenate(連結)の略なのでファイルの中身を連結して一度に見ることができます。  
連結用にcat_file-1, 2, 3 を用意したのでやってみましょう。  
```
cat cat_file-1 cat_file-2 cat_file-3
```
各行に表示されている文字がそれぞれのファイルの中身になります。  
それぞれのファイルの中身をcatコマンドで確認してみても良いかもしれません。  

### <u>lessコマンド</u>
次はlessコマンドです。  
このコマンドは最初に使うにしては難しいですが、便利なのでぜひ覚えておきましょう。  
とりあえずコマンドを実行します。  
```
less less_file
```
キー操作は慣れるまで難しいですがとても便利です。  
下の表を見ながら実践してみましょう。  

|キー|操作|
|:---:|:---:|
| j | 1行進む |
| k | 1行戻る |
| f or SPACE | 1画面進む |
| b | 1画面戻る |
| q | 終了 |
| / | 検索 |
| n | 次の検索結果へ移動 |
| N | 前の検索結果へ移動 |

### flagを探してみましょう！  
見つかりましたか？

lessコマンドを終了する場合は `q` を押しましょう。  
元の画面に戻ったと思います。  

# 4.ファイルを編集しよう
コマンド操作の演習もいよいよラストです。  
最後はファイルを編集します。  
今回はvimというエディタを使います。  
少し操作が特殊ですが頑張りましょう。  
study-group-1st/work-3に移動してファイルをvimコマンドで開きます。  
```
vim vim_file
```
これもlessコマンドのようにキー操作があります。  

|キー|操作|
|:---:|:---:|
| k | 上 |
| j | 下 |
| h | 左 |
| l | 右 |
| i | カーソルの左側から入力 |
| a | カーソルの右側から入力 |
| Esc | モードから抜ける |
| :w | 上書き保存 |
| :q | 終了 |

`i` や `a` を押すとインサートモードという入力専用モードに切り替わります。  
`:w` や `:q` と入力して、保存・終了したい場合は `Esc` を押してモードから抜けてから入力します。  

困ったらEscを連打しましょう()

### <u>ファイル内の演習問題に取り組んでみましょう。</u>  

vimにはこれ以外にもたくさんの操作があります。  
慣れたらとても便利なので余裕があれば練習してみるのも良いかも知れません。
```
vimtutor
```
というコマンドを実行するとvimの練習ができます。  
また、vimututorをしなくても `vim キー操作` と調べると見やすくまとめられているサイトも複数出てくるので参考にすると良いと思います。  

# ミニキャン言語の開発環境を作ろう
コマンドの演習も終わり、いよいよ環境構築です。  
難しいことは考えず、コマンドを実行して環境を整えていきましょう。  
今回使う大元のソースをまたgithubから落としていきます。  
```
git clone https://github.com/yamaguchi1024/mc-lang-1.git
```
完了したらmc-lang-1ディレクトリに移動しましょう。(ディレクトリの移動はもう完璧ですね)  
移動後、Makefileというファイルがあるので、それを書き換えます。  
```
clang++ -> clang++-8
llvm-config -> llvm-config-8
```
次にclang++とllvmのversion8をインストールします。  
```
sudo apt-get install clang++-8 lldb-8 lld-8
```
では、環境が整ったのでmakeコマンドを使ってmc実行ファイルを作ろうと思います。  
```
make
```
同じファイル内に `mc` というファイルが追加されたでしょうか。  
追加されていれば成功です。  
これで環境はできたのでいよいよ、開発をしていくことになります。  

<br><br>


# コマンド演習番外編

## コマンドのオプション
前半のコマンド演習では `cd` や `ls` と単純に打つだけでした。  
しかし大体のコマンドにはオプションと呼ばれる追加機能のようなものがあります。  
例として自分がよく使う `ls` コマンドのオプションを紹介します。  
```
ls -l
ls -a
```
`ls -l` ではファイル/ディレクトリ名だけでなく変更日やサイズを確認することができます。  
また、`ls -a` オプションでは隠しファイルと呼ばれるファイルを見ることができます。  
隠しファイルは普段触れることはないと思います。  
実態は`.<ファイル名>`というファイル/ディレクトリです。  
では実際にオプションを使ってみましょう。  

study-gropu-1st/work-4に移動し、`ls -l` を使いましょう。  
ファイルの情報が見られましたか？  
見ることができたら今度は隠しファイルを見てみましょう。  

他のコマンドにも多くのオプションがあります。  
今回紹介した `cat` や `less` にもオプションがあります。  
オプションの確認は
```
man <コマンド名>
```
を実行して確認することができます。  
manコマンドはlessと同じ方法でページを進めることができます。  
lessコマンドの操作を忘れてしまった人は、前に戻るか検索してください。  

manコマンドに慣れるまでは`less コマンド オプション` のように検索した方が速いかもれしれません。  
(私は未だにすぐ検索してしまいます。)  
自分のやりやすい方を選べば良いと思います。  

# 学習の進め方
```
https://github.com/yamaguchi1024/mc-lang-1
```
上記サイトのREADME.mdに書いてある課題に挑戦してください。  
1.2の環境構築までは一緒にやっているので大丈夫だと思います。  
1.3に挑戦する場合の例を書きます。  
```
#### 1.3 数字のトークナイザを実装してみよう

以降の課題は実際にソースコードを書く課題になります。少し難しそうに見えるかもしれませんが、コメントに誘導を付けたので心配しなくても大丈夫です。

`lexer.h`の中で`TODO 1.3`とコメントアウトがしてある箇所があるのでそこを探して下さい。コメントに実装の方針が書いてあるので、それを参考に数字をトークナイズするコードを書いて下さい。

この課題が解き終わると、`test/test1.mc`が正常にコンパイル出来るようになるはずです。期待される出力は`test/test1_expected_output.txt`にあります。
```
1.3の課題は上記のようになっていますので、まずはlexer.hを編集します。  
lexer.hはsrcディレクトリ内にあるのでcdコマンドでsrcに移動してから`vim lexer.h`とするか、mc-lang-1にいる状態で`vim src/lexer.h`と実行してください。  
vimを使わない人は好きな環境でファイルを開いて編集を行なってください。  
Ubuntu(Linux)でもwindowsのようにマウスのクリックでフォルダの移動やファイルを開く操作は行えます。    

開いてTODO1.3と書いてある場所を見つけます。  
見つけると以下のようなことが書いてあると思います。
```
// TODO 1.3: 数字のパーシングを実装してみよう
// 今読んでいる文字(lastChar)が数字だった場合(isdigit(lastChar) == true)は、
// 数字が終わるまで読み、その数値をnumValにセットする。
// 1. lastCharが数字かチェックする e.g. if (isdigit(lastChar)) {..

~ 省略 ~

// ここに実装して下さい
```
コメントにそって`ここに実装してください。`という下にプログラムを書きます。  
1番だけ進めると以下のようになると思います。  
```
// ここに実装して下さい
if (isdigit(lastChar)) {

}
```
それを今回は７番まで行なってください。  
書き終えたらmc-lang-1に移動してmakeをします。  
自分がmc-lang-1にいるかわからない場合は`pwd`というコマンドを実行してください。  
一番最後がmc-lang-1になっていれば大丈夫です。  
errorという表示がなくmcファイルが作成されたら成功です。  
mcファイルが新しく出来たものか判断しにくい場合は
```
make clean
もしくは
rm mc
```
でmcファイルが削除できますので、削除してからmakeをしてみてください。  
TODO 1.3はこれだけで終わりではなくて
```
この課題が解き終わると、test/test1.mcが正常にコンパイル出来るようになるはずです。期待される出力はtest/test1_expected_output.txtにあります。
```
という文がREADME.mdもしくはサイトに書いてあります。  
なのでmc-lang-1に移動して
```
./mc test/test1.mc
```
を実行してください。  
```
cat test/test_expected_output.txt
```
を実行して、表示されたものが期待される出力と同じになったかを確認します。  
もし同じなら次の課題に進んでください。  

実行しても同じ結果にならない場合はソースが間違っているので、エラーメッセージ等を頼りにソースを正しいものに書き換えてください。  
わからない場合はSlackで質問してください。  

以上が学習の進め方となります。  
他にわからないとことがある場合はSlackで質問してください。  

# Macでの環境構築
基本はLinuxの場合と同じですが、Makefileの書き換えが少し異なります。  
Macでは`apt install`が使えないので代わりに`brew install`というのを使います。  
```
/usr/bin/ruby -e "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install)"
```
まずは上記のコマンドをコピーして実行し、brewが使えるようにします。  
brewがインストールできたら`brew -v`でバージョンが表示されることを確認してください。  
確認できたらインストール完了です。  

そうしたらまず`clang++`が使えるかを確認します。  
```
clang++ -v
```
これも同じようにバージョンが表示されれば大丈夫です。  
バージョンが表示されない場合はインストールが必要になります。  
```
brew install clang++
```
でclang++をインストールしてください。  
インストールできたら同じようにバージョンを確認して完了です。  


Makefileの書き換えを行います。  
```
llvm-config -> /usr/local/Cellar/llvm/9.0.0_1/bin/llvm-config
```
makeコマンドを実行して、mc-lang-1ディレクトリ内にmc実行ファイルが生成されたかを確認してください。  
されていれば成功です。  

されていない場合、バージョン等の違いでPathが違うかもしれません。  
```
find / -name "llvm-config*"
```
上記のコマンドを実行して、数行ほど出たところで`Ctrl + c`で実行を止めます。  
その中で似たようなパスを探してください。  
見つけた形でMakefileを書き換えてmakeすればできると思います。  

